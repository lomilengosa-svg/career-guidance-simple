<!DOCTYPE html>
<html>
<head>
    <title>Career Guidance Dashboard</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
        }
        .navbar {
            background-color: #333;
            padding: 15px;
            color: white;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .main-content {
            padding: 20px;
            max-width: 1200px;
            margin: 0 auto;
        }
        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        .dashboard-card {
            background-color: #f5f5f5;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .dashboard-card h3 {
            margin-top: 0;
            color: #333;
        }
        .action-button {
            background-color: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
        }
        .action-button:hover {
            background-color: #0056b3;
        }
        .logout-button {
            background-color: #dc3545;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
        }
        .hidden {
            display: none;
        }
    </style>
</head>
<body>
    <div class="navbar">
        <h2>Career Guidance System</h2>
        <div>
            <span id="userEmail"></span>
            <button class="logout-button" onclick="logout()">Logout</button>
        </div>
    </div>

    <div class="main-content">
        <h1>Welcome to Your Dashboard</h1>
        
        <!-- Student Dashboard -->
        <div id="studentDashboard" class="hidden">
            <div class="dashboard-grid">
                <div class="dashboard-card">
                    <h3>My Applications</h3>
                    <p>View and manage your institution applications</p>
                    <button class="action-button" onclick="viewApplications()">View Applications</button>
                </div>
                <div class="dashboard-card">
                    <h3>My Profile</h3>
                    <p>Update your academic information and certificates</p>
                    <button class="action-button" onclick="updateProfile()">Update Profile</button>
                </div>
                <div class="dashboard-card">
                    <h3>Job Matches</h3>
                    <p>View jobs matching your qualifications</p>
                    <button class="action-button" onclick="viewJobs()">View Jobs</button>
                </div>
            </div>
        </div>

        <!-- Institution Dashboard -->
        <div id="institutionDashboard" class="hidden">
            <div class="dashboard-grid">
                <div class="dashboard-card">
                    <h3>Manage Courses</h3>
                    <p>Add, edit, or remove courses</p>
                    <button class="action-button" onclick="manageCourses()">Manage Courses</button>
                </div>
                <div class="dashboard-card">
                    <h3>Applications</h3>
                    <p>Review student applications</p>
                    <button class="action-button" onclick="reviewApplications()">Review Applications</button>
                </div>
                <div class="dashboard-card">
                    <h3>Institution Profile</h3>
                    <p>Update institution information</p>
                    <button class="action-button" onclick="updateInstitutionProfile()">Update Profile</button>
                </div>
            </div>
        </div>

        <!-- Company Dashboard -->
        <div id="companyDashboard" class="hidden">
            <div class="dashboard-grid">
                <div class="dashboard-card">
                    <h3>Job Postings</h3>
                    <p>Manage your job postings</p>
                    <button class="action-button" onclick="manageJobs()">Manage Jobs</button>
                </div>
                <div class="dashboard-card">
                    <h3>Applications</h3>
                    <p>Review job applications</p>
                    <button class="action-button" onclick="reviewJobApplications()">Review Applications</button>
                </div>
                <div class="dashboard-card">
                    <h3>Company Profile</h3>
                    <p>Update company information</p>
                    <button class="action-button" onclick="updateCompanyProfile()">Update Profile</button>
                </div>
            </div>
        </div>
    </div>

    <script type="module">
        import { auth } from './firebase.js';
        import { onAuthStateChanged, signOut } from 'firebase/auth';
        import config from './config.js';

        // Make functions available globally
        window.logout = async function() {
            try {
                await signOut(auth);
                localStorage.removeItem('token');
                localStorage.removeItem('role');
                window.location.href = 'index.html';
            } catch (error) {
                console.error('Error signing out:', error);
                alert('Error signing out');
            }
        };

        window.viewApplications = function() {
            // Implement application viewing logic
            alert('Viewing applications...');
        };

        window.updateProfile = function() {
            // Implement profile update logic
            alert('Updating profile...');
        };

        window.viewJobs = function() {
            // Implement job viewing logic
            alert('Viewing jobs...');
        };

        window.manageCourses = function() {
            // Implement course management logic
            alert('Managing courses...');
        };

        window.reviewApplications = function() {
            // Implement application review logic
            alert('Reviewing applications...');
        };

        window.updateInstitutionProfile = function() {
            // Implement institution profile update logic
            alert('Updating institution profile...');
        };

        window.manageJobs = function() {
            // Implement job management logic
            alert('Managing jobs...');
        };

        window.reviewJobApplications = function() {
            // Implement job application review logic
            alert('Reviewing job applications...');
        };

        window.updateCompanyProfile = function() {
            // Implement company profile update logic
            alert('Updating company profile...');
        };

        // Check authentication state
        onAuthStateChanged(auth, async (user) => {
            if (user) {
                // User is signed in
                document.getElementById('userEmail').textContent = user.email;
                const role = localStorage.getItem('role');
                
                // Show appropriate dashboard based on role
                document.getElementById('studentDashboard').classList.add('hidden');
                document.getElementById('institutionDashboard').classList.add('hidden');
                document.getElementById('companyDashboard').classList.add('hidden');
                
                if (role === 'student') {
                    document.getElementById('studentDashboard').classList.remove('hidden');
                } else if (role === 'institution') {
                    document.getElementById('institutionDashboard').classList.remove('hidden');
                } else if (role === 'company') {
                    document.getElementById('companyDashboard').classList.remove('hidden');
                }
            } else {
                // User is signed out
                window.location.href = 'index.html';
            }
        });
    </script>
</body>
</html>